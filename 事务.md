## JDBCTemplate
Spring对JDBC进行封装 使用JDBCTemplate方便实现对数据库的操作
搭建模块 引入依赖 添加配置 创建properties 配置Spring和jdbc.properties
![alt text](images-事务\1.png)

queryForObject(String sql,RowMapper<T> rowMapper,Object...args)
RowMapper<T>对数据进行封装
一般使用BeanPropertyMapper实现类

### 1.进行手动封装结果表达式 
![alt text](images-事务\2.png)

###  2.用实现类自动装配
![alt text](images-事务\3.png)

查询单个或多个值
![alt text](images-事务\4.png)

## 声明式事务
数据库事务是访问并可能操作一个数据库操作序列 
ACID特性
原子性Atomicity 一致性Consistency 
隔离性Isolation 持久性Durability

xml里面加添加配置 组件扫描
<context:component-scan base-package="...">
</context:component-scan>
创建MVC三层准备工作DAO@Repository Service Controller

## 加入事务
添加事务配置
<tx:annotation-driven transaction-manager="transactionManager"/> 
![alt text](images-事务\5.png)

利用@Transactional注解进行实现
属性设置:readOnly=true设置只读 超时设置:超时时间超过直接抛出异常回滚
回滚策略:设置哪些不回滚 隔离级别:读问题 
传播行为:事务方法之间调用,事务如何使用

![alt text](images-事务\6.png)

事务传播行为
一个Service调用另一个Service
注入另一个Service 加上事务(在方法或类上) 然后调用另一个Service中的方法
![alt text](images-事务\6.png)
设置默认Required 若有异常会导致两个事务都无法完成会回滚
设置Requires_NEW 会将发生异常的那个事务回滚而为异常的正常完成 因为创建了两个事务 

## 设置配置类完成全注解开发
@Configuration @Component("路径") 
@EnableTransactionManagement 开启事务管理
数据源datasource 用@Bean getDataSource方法实现
![alt text](images-事务\8.png)

### 1.环境准备
创建MVC三层
### 2.创建Spring配置文件
(1)开启组件扫描 <context:component-scan base-ackage="路径"> 
(2)创建数据源 引入外部属性文件
![alt text](images-事务\9.png)
(3)创建JdbcTemplate 注入数据源
![alt text](images-事务\10.png)
(4)创建事务管理器 注入数据源 
![alt text](images-事务\11.png)
(5)配置事务通知
![alt text](images-事务\12.png)
(6)配置切入点表达式 把事务通知添加到方法上
expression中execution加上包的路径*.*(..)表示Service包中所有类的所有方法
![alt text](images-事务\13.png)
注意配置方法中的名字和配置事务通知的名字前缀匹配 不然无法触发事务
如前面在配置事务那应该加上 <tx:method name="buy*">
不然buyBook方法出错后无法触发回滚
